<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - HeartLink</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>

<body>
    <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="sidebar glass-card">
            <div class="user-info">
                <img id="profileImage" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="Profile"
                    class="avatar">
                <h3 id="userName" class="glow-text">Loading...</h3>
                <p id="userUsername" class="text-muted" style="font-size: 0.9rem; margin-bottom: 5px;"></p>
                <p id="userAgeGender" class="text-muted"></p>
                <button class="btn-outline btn-small" onclick="loadView('profile')">Edit Profile</button>
            </div>

            <nav class="side-menu">
                <a href="#" class="menu-item active" onclick="loadView('chatbot', this)"><i
                        class="fa-solid fa-robot"></i> AI Support</a>
                <a href="#" class="menu-item" onclick="loadView('matches', this)"><i class="fa-solid fa-fire"></i> Find
                    Matches</a>
                <a href="#" class="menu-item" onclick="loadView('requests', this)"><i
                        class="fa-solid fa-heart-circle-check"></i> Requests <span class="badge" id="reqBadge"
                        style="display:none">0</span></a>
                <a href="#" class="menu-item" onclick="loadView('messages', this)"><i
                        class="fa-solid fa-comment-dots"></i> Messages</a>
                <a href="#" class="menu-item" onclick="logout()"><i class="fa-solid fa-arrow-right-from-bracket"></i>
                    Logout</a>
            </nav>
        </aside>

        <!-- Main Content Panel -->
        <main class="main-panel glass-card">
            <!-- Dynamic Content Container -->
            <div id="contentArea"></div>
        </main>
    </div>

    <!-- Templates for logical views -->

    <!-- Profile Template -->
    <template id="tpl-profile">
        <h2 class="view-title">Your Profile</h2>
        <form id="profileForm" class="grid-form">
            <div class="input-group">
                <i class="fa-solid fa-at"></i>
                <input type="text" id="pUsername" disabled title="Username cannot be changed">
            </div>
            <div class="input-group">
                <i class="fa-solid fa-user"></i>
                <input type="text" id="pName" placeholder="Name" required>
            </div>
            <div class="input-group">
                <i class="fa-solid fa-calendar"></i>
                <input type="number" id="pAge" placeholder="Age" required>
            </div>
            <div class="input-group full-width">
                <label>Looking For (e.g., friendship, relationship, emotional support)</label>
                <input type="text" id="pLookingFor" placeholder="Friendship, Relationship, etc.">
            </div>
            <div class="input-group full-width">
                <label>Interests (comma separated)</label>
                <input type="text" id="pInterests" placeholder="music, coding, travel">
            </div>
            <div class="input-group full-width">
                <label>Bio</label>
                <textarea id="pBio" rows="4" placeholder="Tell us about yourself..."></textarea>
            </div>
            <button type="submit" class="btn-primary" style="grid-column: 1 / -1;">Save Changes</button>
        </form>

        <hr style="border: 1px solid var(--glass-border); margin: 30px 0;">
        <h3 class="view-title" style="font-size: 1.5rem;">Send Feedback to Admin</h3>
        <form id="feedbackForm" class="grid-form">
            <div class="input-group full-width">
                <textarea id="fMessage" rows="3" placeholder="Tell us how we can improve..." required></textarea>
            </div>
            <button type="submit" class="btn-outline" style="grid-column: 1 / -1; margin-top: 10px;">Submit
                Feedback</button>
        </form>
    </template>

    <!-- Chatbot Template -->
    <template id="tpl-chatbot">
        <div class="chat-container">
            <div class="chat-header">
                <h3><i class="fa-solid fa-robot glow-text"></i> HeartBot</h3>
                <p>Emotional Support & Suggestions</p>
            </div>
            <div class="chat-messages" id="botChatBox">
                <div class="message bot">
                    <div class="bubble">Hello! I am HeartLink's AI. I'm here to support you, chat, or suggest songs. How
                        are you feeling today?</div>
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="botInput" placeholder="Type your feelings..." autocomplete="off">
                <button onclick="sendBotMessage()" class="btn-icon"><i class="fa-solid fa-paper-plane"></i></button>
            </div>
        </div>
    </template>

    <!-- Matches Template -->
    <template id="tpl-matches">
        <h2 class="view-title">Discover Matches</h2>
        <div class="filters" style="margin-bottom: 20px;">
            <div class="input-group" style="max-width: 400px; margin: 0 auto;">
                <i class="fa-solid fa-search"></i>
                <input type="text" id="matchSearchInput" placeholder="Search by name, username or interests..."
                    autocomplete="off" onkeyup="filterMatches()">
            </div>
        </div>
        <div class="grid-container" id="matchesGrid">
            <div class="text-center w-100"><i class="fa-solid fa-spinner fa-spin"></i> Loading...</div>
        </div>
    </template>

    <!-- Requests Template -->
    <template id="tpl-requests">
        <h2 class="view-title">Connection Requests</h2>
        <div id="requestsList" class="list-container">
            <p>Loading requests...</p>
        </div>
    </template>

    <!-- Messages Template -->
    <template id="tpl-messages">
        <h2 class="view-title">Private Chats</h2>
        <div class="chat-layout">
            <div class="contact-list glass-card" id="matchList">
                <div class="text-center"><i class="fa-solid fa-spinner fa-spin"></i> Loading...</div>
            </div>
            <div class="chat-window glass-card" id="privateChatWindow" style="display: none;">
                <div class="chat-header">
                    <h3 id="chatPartnerName">Select a match</h3>
                </div>
                <div class="chat-messages" id="privateChatBox"></div>
                <div class="chat-input-area">
                    <input type="text" id="privateInput" placeholder="Type an encrypted message..." autocomplete="off">
                    <button id="sendPrivateBtn" class="btn-icon"><i class="fa-solid fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </template>

    <!-- Admin Users Template -->
    <template id="tpl-adminUsers">
        <h2 class="view-title">Admin: Registered Users</h2>
        <div class="glass-card" style="padding: 20px; margin-bottom: 20px; text-align: center;">
            <h3 class="glow-text">Real-Time Online Users: <span id="onlineCountBadge">1</span></h3>
        </div>
        <div id="adminUsersList" class="list-container">
            <p>Loading users...</p>
        </div>
    </template>

    <!-- Admin Feedback Template -->
    <template id="tpl-adminFeedback">
        <h2 class="view-title">Admin: User Feedback</h2>
        <div id="adminFeedbackList" class="list-container">
            <p>Loading feedback...</p>
        </div>
    </template>

    <script src="js/app.js"></script>
</body>

</html>